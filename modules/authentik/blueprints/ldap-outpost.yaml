version: 1
metadata:
  name: LDAP Outpost Setup
  description: Creates LDAP provider and outpost for authentication

entries:
  - id: ldap-provider
    model: authentik_providers_ldap.ldapprovider
    identifiers:
      name: LDAP Provider
    attrs:
      name: LDAP Provider
      base_dn: dc=nixmox,dc=lan
      bind_mode: direct
      search_mode: direct
      mfa_support: true

  - id: ldap-application
    model: authentik_core.application
    identifiers:
      slug: ldap-directory
    attrs:
      name: LDAP Directory
      slug: ldap-directory

  - id: ldap-provider-application-link
    model: authentik_providers_ldap.ldapprovider
    identifiers:
      name: LDAP Provider
    attrs:
      application: !KeyOf ldap-application

  - id: ldap-outpost
    model: authentik_outposts.outpost
    identifiers:
      name: LDAP Outpost
    attrs:
      name: LDAP Outpost
      type: ldap
    depends_on:
      - ldap-provider
    relations:
      providers:
        - !KeyOf ldap-provider